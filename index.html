<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ulangan Sejarah - Kerajaan Sunda</title>
    <style>
        :root {
            --primary: #1a237e; /* Warna Biru Sekolah */
            --accent: #ffab00; /* Warna Kuning Peringatan */
            --bg: #f5f5f5;
            --white: #ffffff;
            --text: #333333;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        
        body { 
            background-color: var(--bg); 
            color: var(--text); 
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden; 
        }

        /* --- LAYOUT UTAMA --- */
        .container {
            width: 100%;
            max-width: 600px; /* Batas lebar agar enak dilihat di HP & Laptop */
            margin: 0 auto;
            background: var(--white);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        /* --- HEADER --- */
        header {
            background: var(--primary);
            color: var(--white);
            padding: 20px;
            text-align: center;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 10;
        }

        .logo { width: 80px; height: auto; margin-bottom: 10px; background: white; border-radius: 50%; padding: 5px; }
        h1 { font-size: 1.2rem; font-weight: bold; margin-bottom: 5px; }
        h2 { font-size: 0.9rem; opacity: 0.9; font-weight: normal; }

        /* --- TIMER STICKY --- */
        #timer-bar {
            background: #333;
            color: #fff;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            display: none; /* Muncul saat ujian mulai */
        }

        /* --- HALAMAN (Pages) --- */
        .page { display: none; padding: 20px; flex: 1; }
        .page.active { display: block; animation: fadeIn 0.3s; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- FORM INPUT --- */
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--primary); }
        input, select { 
            width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 10px; font-size: 1rem; 
            outline: none; transition: 0.3s;
        }
        input:focus, select:focus { border-color: var(--primary); }
        
        .rules-box {
            background: #fff3e0; border-left: 5px solid var(--accent);
            padding: 15px; margin-bottom: 20px; font-size: 0.9rem; border-radius: 5px;
        }

        /* --- TAMPILAN SOAL --- */
        .question-card {
            margin-bottom: 80px; /* Ruang untuk tombol navigasi di bawah */
        }
        
        .q-number {
            font-size: 0.9rem; color: #666; margin-bottom: 10px; font-weight: bold;
            display: flex; justify-content: space-between;
        }

        .q-text { font-size: 1.1rem; margin-bottom: 20px; line-height: 1.5; font-weight: 500; }

        .option-btn {
            display: block; width: 100%; text-align: left;
            padding: 15px; margin-bottom: 12px;
            background: #f8f9fa; border: 2px solid #e0e0e0; border-radius: 12px;
            cursor: pointer; font-size: 1rem; transition: 0.2s;
            position: relative;
        }

        .option-btn:hover { background: #e8eaf6; }
        
        /* Jika dipilih */
        .option-btn.selected {
            background: #e8eaf6; border-color: var(--primary); color: var(--primary); font-weight: 600;
        }

        /* --- NAVIGATION BAR BAWAH --- */
        .nav-bar {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: var(--white);
            padding: 15px 20px;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
            display: none; /* Muncul saat ujian */
            justify-content: center; /* Center konten */
            z-index: 99;
        }
        
        .nav-content {
            width: 100%;
            max-width: 600px; /* Samakan dengan container */
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .btn {
            padding: 12px 25px; border: none; border-radius: 50px;
            font-size: 1rem; font-weight: bold; cursor: pointer;
            transition: 0.2s; flex: 1;
        }

        .btn-primary { background: var(--primary); color: white; }
        .btn-secondary { background: #e0e0e0; color: #333; }
        .btn-success { background: #2e7d32; color: white; }
        .btn:active { transform: scale(0.98); }

        /* --- PERINGATAN FULLSCREEN --- */
        #fullscreen-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); color: white;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 9999; text-align: center; padding: 20px; display: none;
        }

        /* --- LOADING SPINNER --- */
        #loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9); display: none;
            align-items: center; justify-content: center; z-index: 200; flex-direction: column;
        }
        .spinner { width: 40px; height: 40px; border: 5px solid #f3f3f3; border-top: 5px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <div id="fullscreen-overlay">
        <h2>‚ö†Ô∏è Mode Layar Penuh Diperlukan</h2>
        <p style="margin: 15px 0;">Sistem mendeteksi Anda keluar dari mode layar penuh atau berpindah aplikasi.</p>
        <button class="btn btn-primary" onclick="requestFullscreen()">KEMBALI KE UJIAN</button>
    </div>

    <div id="loading-overlay">
        <div class="spinner"></div>
        <p style="margin-top: 15px; font-weight: bold;">Mengirim Jawaban...</p>
    </div>

    <div class="container">
        
        <header>
            <img src="logo.png" alt="Logo" class="logo" onerror="this.style.display='none'">
            <h1>SMA NEGERI 5 TANAH PUTIH</h1>
            <h2>KABUPATEN ROKAN HILIR</h2>
        </header>

        <div id="timer-bar">Sisa Waktu: <span id="time-display">13:45</span></div>

        <div id="page-login" class="page active">
            <div class="rules-box">
                <h3>üìú Tata Cara & Aturan</h3>
                <ul style="margin-left: 20px; margin-top: 10px; font-size: 0.85rem;">
                    <li>Waktu pengerjaan: <strong>13 Menit 45 Detik</strong>.</li>
                    <li>Sistem <strong>Anti-Curang</strong> Aktif.</li>
                    <li>Dilarang: Keluar aplikasi, screenshot, split screen.</li>
                    <li>Pelanggaran akan menyebabkan ujian tertutup otomatis.</li>
                </ul>
            </div>

            <form id="login-form">
                <div class="form-group">
                    <label>Nama Lengkap</label>
                    <input type="text" id="nama" placeholder="Ketik nama anda..." required>
                </div>
                <div class="form-group">
                    <label>Kelas</label>
                    <select id="kelas" required>
                        <option value="">-- Pilih Kelas --</option>
                        <option value="10 Satu">10 Satu</option>
                        <option value="10 Dua">10 Dua</option>
                        <option value="10 Tiga">10 Tiga</option>
                        <option value="10 Empat">10 Empat</option>
                        <option value="11 Satu">11 Satu</option>
                        <option value="11 Dua">11 Dua</option>
                        <option value="11 Tiga">11 Tiga</option>
                        <option value="12 Satu">12 Satu</option>
                        <option value="12 Dua">12 Dua</option>
                        <option value="12 Tiga">12 Tiga</option>
                    </select>
                </div>
                <div class="form-group" style="display: flex; align-items: start; gap: 10px;">
                    <input type="checkbox" id="jujur" style="width: 20px;" required>
                    <label for="jujur" style="font-size: 0.9rem; font-weight: normal;">Saya berjanji mengerjakan soal ini dengan jujur tanpa bantuan orang lain atau internet.</label>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 10px;">MULAI UJIAN</button>
            </form>
            <br>
            <center><small>Copyright 2026 Daniel Riadi Sianipar</small></center>
        </div>

        <div id="page-exam" class="page">
            <div id="question-container" class="question-card">
                </div>
        </div>

        <div id="page-result" class="page" style="text-align: center;">
            <div style="font-size: 4rem; margin: 20px 0;">üéâ</div>
            <h2 style="color: var(--primary);">Ujian Selesai!</h2>
            <p>Terima kasih telah mengerjakan dengan jujur.</p>
            
            <div style="background: #e3f2fd; padding: 20px; border-radius: 15px; margin: 30px 0;">
                <p>Nilai Kamu</p>
                <h1 id="score-display" style="font-size: 3.5rem; color: var(--primary);">0</h1>
                <div style="display: flex; justify-content: center; gap: 20px; margin-top: 10px;">
                    <span style="color: green;">‚úî Benar: <span id="correct-display">0</span></span>
                    <span style="color: red;">‚úñ Salah: <span id="wrong-display">0</span></span>
                </div>
            </div>

            <button onclick="window.print()" class="btn btn-secondary" style="width: 100%;">Simpan Bukti (PDF)</button>
        </div>

    </div>

    <div class="nav-bar" id="exam-nav">
        <div class="nav-content">
            <button class="btn btn-secondary" onclick="prevQuestion()" id="btn-prev">Sebelumnya</button>
            <button class="btn btn-primary" onclick="nextQuestion()" id="btn-next">Berikutnya</button>
        </div>
    </div>

    <script>
        // --- KONFIGURASI ---
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyB8aCrE9OX5kxZKgsJkMc6omURTGzNh1OciPbpXzXGpMlCY7f4MmCRNUzuj79OuouR/exec'; // <--- PASTE LINK DI SINI
        const examDuration = 13 * 60 + 45; // 13 menit 45 detik dalam detik

        // --- DATA SOAL (15 Soal) ---
        const questionsSource = [
            { q: "Teori masuknya Hindu-Buddha ke Indonesia yang menyatakan bahwa peran aktif dalam penyebaran agama dan kebudayaan dilakukan oleh kaum brahmana (pendeta) atas undangan penguasa lokal dinamakan teori...", options: ["Waisya", "Ksatria", "Brahmana", "Arus Balik", "Sudra"], ans: 2 },
            { q: "Salah satu bukti kuat yang mendukung teori Brahmana adalah...", options: ["Banyaknya prasasti berbahasa Sanskerta dan huruf Pallawa.", "Adanya penemuan arca-arca dewa-dewi India.", "Penggunaan sistem kasta dalam masyarakat.", "Ditemukannya candi-candi bercorak Hindu.", "Munculnya kerajaan-kerajaan bercorak Hindu-Buddha."], ans: 0 },
            { q: "Teori 'Arus Balik' yang dikemukakan oleh F.D.K. Bosch menekankan pada peran...", options: ["Pedagang India yang menetap dan menikah dengan penduduk lokal.", "Bangsa Indonesia sendiri yang aktif belajar ke India dan kembali menyebarkan ilmunya.", "Kaum ksatria India yang kalah perang lalu mengungsi ke Nusantara.", "Para brahmana yang diundang secara khusus untuk menobatkan raja.", "Misionaris agama Buddha dari India yang menyebarkan ajaran."], ans: 1 },
            { q: "Salah satu perubahan signifikan dalam kehidupan politik masyarakat Indonesia setelah masuknya pengaruh Hindu-Buddha adalah...", options: ["Sistem pemerintahan kesukuan digantikan oleh sistem kerajaan (monarki).", "Munculnya demokrasi langsung di tingkat desa.", "Kekuasaan dipegang sepenuhnya oleh dewan perang.", "Pemimpin dipilih berdasarkan kekayaan dan kepemilikan tanah.", "Sistem pemerintahan menjadi teokrasi yang dipimpin oleh pendeta."], ans: 0 },
            { q: "Dalam bidang ekonomi, masuknya pengaruh Hindu-Buddha memperkuat kegiatan...", options: ["Pertanian subsisten di pedalaman.", "Perburuan dan meramu.", "Pelayaran dan perdagangan antarpulau serta internasional.", "Industri manufaktur berskala besar.", "Ekonomi barter dalam skala kecil."], ans: 2 },
            { q: "Walaupun pengaruh Hindu-Buddha kuat, unsur-unsur kebudayaan asli Indonesia (lokal) tetap bertahan dan berakulturasi. Hal ini dapat dilihat dari...", options: ["Bentuk candi seperti Prambanan dan Borobudur yang memiliki unsur punden berundak.", "Penggunaan bahasa Sanskerta secara penuh menggantikan bahasa lokal.", "Penghapusan sistem kepercayaan animisme dan dinamisme.", "Raja dianggap sebagai titisan dewa secara mutlak tanpa syarat.", "Seluruh sistem hukum adat diganti dengan kitab hukum Manu."], ans: 0 },
            { q: "Sistem sosial yang dibawa agama Hindu adalah sistem kasta (caturwarna). Namun dalam penerapannya di Indonesia, sistem kasta tidak seketat di India karena...", options: ["Pengaruh Buddha yang menentang sistem kasta lebih kuat.", "Masyarakat Indonesia sudah memiliki stratifikasi sosial sendiri yang berakulturasi.", "Kaum brahmana dari India melonggarkan aturannya.", "Semua kasta memiliki hak yang sama dalam politik.", "Sistem kasta hanya berlaku untuk kaum imigran India."], ans: 1 },
            { q: "Kerajaan Sunda yang bercorak Hindu berkembang di wilayah Jawa Barat dengan ibu kota yang terkenal, yaitu...", options: ["Sundapura", "Pakuan Pajajaran", "Kawali", "Galuh", "Batutulis"], ans: 1 },
            { q: "Raja Kerajaan Sunda yang paling terkenal dan dianggap mencapai puncak kejayaan, serta disebutkan dalam Prasasti Batu Tulis adalah...", options: ["Prabu Siliwangi (Sri Baduga Maharaja)", "Rakeyan Jayadarma", "Niskala Wastu Kancana", "Prabu Dewa Niskala", "Sanghyang Surawisesa"], ans: 0 },
            { q: "Salah satu bukti tertulis keberadaan Kerajaan Sunda adalah Prasasti Kebon Kopi yang ditemukan di Bogor. Prasasti ini terkenal karena terdapat...", options: ["Cap dua telapak kaki gajah disertai tulisan berbahasa Melayu Kuno.", "Gambar lingga dan yoni sebagai simbol pemujaan.", "Tulisan mengenai perdagangan lada dengan Portugis.", "Silsilah raja-raja Sunda dari Galuh.", "Kutukan bagi yang melanggar peraturan kerajaan."], ans: 0 },
            { q: "Sektor ekonomi utama yang menopang kehidupan Kerajaan Sunda adalah...", options: ["Perdagangan budak dengan Tiongkok.", "Pertanian (padi dan palawija) dan perdagangan komoditas seperti lada dan garam.", "Industri perkapalan dan galangan kapal.", "Penambangan emas dan perak di pegunungan.", "Peternakan kuda dan kerbau untuk ekspor."], ans: 1 },
            { q: "Hubungan Kerajaan Sunda dengan bangsa Eropa tercatat dalam sejarah, terutama dengan Portugis. Perjanjian Sunda-Portugal (1522) berisi tentang...", options: ["Bantuan militer Portugis untuk menaklukkan Majapahit.", "Kerja sama pembangunan benteng di Sunda Kelapa dan perdagangan lada.", "Pernikahan antara raja Sunda dengan putri Portugis.", "Penyebaran agama Kristen di wilayah Sunda.", "Bantuan Portugis dalam melawan Demak."], ans: 1 },
            { q: "Berdasarkan naskah kuno seperti Carita Parahyangan, agama yang berkembang di Kerajaan Sunda adalah...", options: ["Buddha Mahayana", "Hindu aliran Siwa", "Hindu aliran Wisnu", "Kepercayaan Sunda Wiwitan yang telah berakulturasi dengan Hindu", "Islam"], ans: 3 },
            { q: "Salah satu faktor yang menyebabkan melemahnya Kerajaan Sunda pada abad ke-16 adalah...", options: ["Serangan dari Kerajaan Sriwijaya.", "Konflik internal perebutan takhta dan tekanan dari Kesultanan Banten dan Cirebon yang telah Islam.", "Letusan gunung berapi yang menghancurkan ibu kota.", "Wabah penyakit yang meluas.", "Invasi dari Kerajaan Majapahit."], ans: 1 },
            { q: "Peninggalan sejarah Kerajaan Sunda yang berupa kompleks percandian dan menjadi situs arkeologi penting adalah...", options: ["Candi Cangkuang", "Situs Batutulis", "Candi Jiwa", "Kompleks Candi Bojongmenje", "Arca Ganesha di Pasir Angin"], ans: 3 }
        ];

        // --- STATE VARIABEL ---
        let questions = []; // Akan diacak
        let currentIdx = 0;
        let userAnswers = {}; // Menyimpan jawaban {0: 1, 1: 3, ...}
        let timePerQuestion = {};
        let qStartTime = 0;
        let timerInterval;
        let timeLeft = examDuration;
        let activityLog = [];
        let userData = {};

        // --- FUNGSI SYSTEM ---

        // 1. Inisialisasi
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            userData.nama = document.getElementById('nama').value;
            userData.kelas = document.getElementById('kelas').value;

            if(!userData.kelas) return alert("Pilih kelas dulu!");

            // Acak Soal
            questions = shuffle(questionsSource.map((q, i) => ({...q, originalIdx: i})));
            
            startExam();
        });

        function startExam() {
            // Masuk Fullscreen
            requestFullscreen();

            // UI Switch
            document.getElementById('page-login').classList.remove('active');
            document.getElementById('page-exam').classList.add('active');
            document.getElementById('timer-bar').style.display = 'block';
            document.getElementById('exam-nav').style.display = 'flex';

            // Timer & Log
            startTimer();
            logActivity("Mulai Ujian");
            
            // Tampilkan Soal Pertama
            qStartTime = Date.now();
            renderQuestion();
        }

        // 2. Render Soal (Satu per satu)
        function renderQuestion() {
            const container = document.getElementById('question-container');
            const q = questions[currentIdx];
            
            // Cek apakah sudah dijawab sebelumnya
            const selectedOpt = userAnswers[currentIdx];

            let html = `
                <div class="q-number">
                    <span>Soal No. ${currentIdx + 1} dari ${questions.length}</span>
                </div>
                <div class="q-text">${q.q}</div>
                <div class="options">
            `;

            q.options.forEach((opt, idx) => {
                const isSelected = selectedOpt === idx ? 'selected' : '';
                // Konversi index 0,1,2,3,4 ke a,b,c,d,e
                const label = String.fromCharCode(97 + idx); 
                html += `
                    <button class="option-btn ${isSelected}" onclick="selectAnswer(${idx})">
                        <b>${label}.</b> ${opt}
                    </button>
                `;
            });

            html += `</div>`;
            container.innerHTML = html;

            // Update Tombol Navigasi
            const btnNext = document.getElementById('btn-next');
            const btnPrev = document.getElementById('btn-prev');

            btnPrev.disabled = (currentIdx === 0);
            btnPrev.style.opacity = (currentIdx === 0) ? "0.5" : "1";

            if (currentIdx === questions.length - 1) {
                btnNext.innerText = "SELESAI & KIRIM";
                btnNext.classList.remove('btn-primary');
                btnNext.classList.add('btn-success');
            } else {
                btnNext.innerText = "Berikutnya";
                btnNext.classList.remove('btn-success');
                btnNext.classList.add('btn-primary');
            }
        }

        // 3. Handle Jawaban
        window.selectAnswer = function(idx) {
            // Hapus seleksi lama
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(b => b.classList.remove('selected'));
            
            // Tambah seleksi baru
            buttons[idx].classList.add('selected');
            
            // Simpan ke state
            userAnswers[currentIdx] = idx;
        }

        // 4. Navigasi
        window.nextQuestion = function() {
            recordTimePerQuestion();
            if (currentIdx < questions.length - 1) {
                currentIdx++;
                qStartTime = Date.now();
                renderQuestion();
            } else {
                finishExam();
            }
        }

        window.prevQuestion = function() {
            if (currentIdx > 0) {
                recordTimePerQuestion();
                currentIdx--;
                qStartTime = Date.now();
                renderQuestion();
            }
        }

        function recordTimePerQuestion() {
            const dur = Math.round((Date.now() - qStartTime) / 1000);
            if (!timePerQuestion[currentIdx]) timePerQuestion[currentIdx] = 0;
            timePerQuestion[currentIdx] += dur;
        }

        // 5. Timer
        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
                const s = (timeLeft % 60).toString().padStart(2, '0');
                document.getElementById('time-display').innerText = `${m}:${s}`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    alert("Waktu Habis!");
                    finishExam(true); // true = forced
                }
            }, 1000);
        }

        // 6. Finish & Kirim Data
        function finishExam(forced = false) {
            if (!forced && Object.keys(userAnswers).length < questions.length) {
                if(!confirm("Masih ada soal yang belum dijawab. Yakin ingin mengumpulkan?")) return;
            }

            clearInterval(timerInterval);
            recordTimePerQuestion(); // Catat waktu soal terakhir
            document.getElementById('loading-overlay').style.display = 'flex';

            // Hitung Nilai
            let correct = 0;
            let ansString = [];
            let timeString = [];

            questions.forEach((q, i) => {
                const myAns = userAnswers[i];
                if (myAns === q.ans) correct++;
                
                // Format jawaban untuk excel (A/B/C/D/E)
                const charAns = myAns !== undefined ? String.fromCharCode(65 + myAns) : '-';
                ansString.push(`${i+1}:${charAns}`);
                timeString.push(`${i+1}:${timePerQuestion[i]||0}s`);
            });

            const score = Math.round((correct / questions.length) * 100);
            const timeUsed = examDuration - timeLeft;
            const status = forced ? "Waktu Habis/Pelanggaran" : "Selesai Normal";

            // Kirim ke Google Sheets
            const formData = new FormData();
            formData.append('Nama', userData.nama);
            formData.append('Kelas', userData.kelas);
            formData.append('Nilai', score);
            formData.append('Benar', correct);
            formData.append('Salah', questions.length - correct);
            formData.append('Waktu', `${Math.floor(timeUsed/60)}m ${timeUsed%60}s`);
            formData.append('Status', status);
            formData.append('Log Aktivitas', activityLog.join(' | '));
            formData.append('Waktu Per Soal', timeString.join(', '));
            formData.append('Jawaban Siswa', ansString.join(', '));

            fetch(scriptURL, { method: 'POST', body: formData })
                .then(response => {
                    document.getElementById('loading-overlay').style.display = 'none';
                    showResult(score, correct, questions.length - correct);
                })
                .catch(error => {
                    console.error('Error!', error.message);
                    alert("Gagal koneksi ke server, tapi nilai anda sudah dihitung lokal.");
                    document.getElementById('loading-overlay').style.display = 'none';
                    showResult(score, correct, questions.length - correct);
                });
        }

        function showResult(score, correct, wrong) {
            document.exitFullscreen().catch(e => console.log(e));
            document.getElementById('page-exam').classList.remove('active');
            document.getElementById('timer-bar').style.display = 'none';
            document.getElementById('exam-nav').style.display = 'none';
            
            document.getElementById('page-result').classList.add('active');
            document.getElementById('score-display').innerText = score;
            document.getElementById('correct-display').innerText = correct;
            document.getElementById('wrong-display').innerText = wrong;
        }

        // 7. Security & Helper
        function requestFullscreen() {
            const elem = document.documentElement;
            if (elem.requestFullscreen) elem.requestFullscreen();
            else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
        }

        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement && document.getElementById('page-exam').classList.contains('active')) {
                document.getElementById('fullscreen-overlay').style.display = 'flex';
                logActivity("Keluar Fullscreen");
            } else {
                document.getElementById('fullscreen-overlay').style.display = 'none';
            }
        });

        // Anti Copy Paste
        document.addEventListener('contextmenu', event => event.preventDefault());
        document.onkeydown = function(e) {
            if(e.keyCode == 123) return false;
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) return false;
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) return false;
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) return false;
            if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) return false;
        }

        function shuffle(array) {
            let currentIndex = array.length,  randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function logActivity(act) {
            const t = new Date().toLocaleTimeString();
            activityLog.push(`[${t}] ${act}`);
        }

    </script>
</body>
</html>
